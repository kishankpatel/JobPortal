<h1>Candidates</h1>
<br>
<table id="candidate_list" class="table table-hover table-striped">
  <thead>
    <tr>
      <th>Name</th>
      <th>Email</th>
      <th>Applied Job</th>
      <th>Applied On</th>
      <th>Status</th>
      <th>Response status</th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @jobs.each do |job| %>
      <% job.candidates.each do |candidate| %>
        <tr>
          <%invitation = candidate.invitations.where(:job_id => job.id).last%>
          <td><%= candidate.name %></td>
          <td><%= candidate.email %></td>
          <td><a href="/jobs/<%=job.id%>" title="<%=job.description%>"><%= job.title %></a></td>
          <td><%= candidate.candidates_jobs.where(:job_id => job.id).first.created_at %></td>
          <td><%=invitation.present? ? "Invitations sent" : "Invitations not sent"%><br></td>
          <td><%= invitation.present? ? (invitation.is_accepted ? "Accepted" : (invitation.is_accepted == false ? "Rejected" : "Not Decided")) : ""%></td>
          <td><a href="/candidates/invite/<%=candidate.id%>/?job_id=<%=job.id%>">Invite</a></td>
        </tr>
      <% end %>
   <%end%>
  </tbody>
</table>
<br>
<script type="text/javascript">
  $(document).ready(function() {
    $('#candidate_list').DataTable();
  } );
</script>